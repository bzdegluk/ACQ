###############################################################################
#
# IAR ANSI C/C++ Compiler V7.40.2.8542/W32 for ARM        20/Nov/2015  05:04:35
# Copyright 1999-2015 IAR Systems AB.
#
#    Cpu mode     =  thumb
#    Endian       =  little
#    Source file  =  
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\Application\examples\BasicGeneric\End_Point.c
#    Command line =  
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\Application\examples\BasicGeneric\End_Point.c
#        -D USE_STDPERIPH_DRIVER -D VECT_TAB_FLASH -D STM32L1XX_MD -D
#        IAR_ARM_CM3 -D USE_FULL_ASSERT -D SPIRIT_USE_FULL_ASSERT -D
#        USE_SYSTICK_DELAY -D SDK -lC
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\DZ-SB-DISC01\List\
#        -o
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\DZ-SB-DISC01\Obj\
#        --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa
#        --no_clustering --no_scheduling --debug --endian=little
#        --cpu=Cortex-M3 -e --fpu=None --dlib_config "C:\Program Files
#        (x86)\IAR Systems\Embedded Workbench
#        7.2\arm\INC\c\DLib_Config_Normal.h" -I
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\.\
#        -I
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\..\Application\
#        -I
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\..\Application\examples\
#        -I
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\..\Application\runtime\
#        -I
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\..\..\STM32L\SDK_Eval_STM32L\Source\inc\
#        -I
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\..\SPIRIT1_Library\Source\inc\
#        -I
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\..\SDK_Eval_Util\Source\inc\
#        -I
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\..\..\STM32L\STM32L1xx_StdPeriph_Lib\Source\CMSIS\CM3\DeviceSupport\ST\STM32L1xx\
#        -I
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\..\..\STM32L\STM32L1xx_StdPeriph_Lib\Source\STM32L1xx_StdPeriph_Driver\inc\
#        -I
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\..\..\STM32L\SDK_Virtual_Com\Source\inc\
#        -I
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\..\..\STM32L\STM32_USB-FS-Device_Lib\Source\inc\
#        -I
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\..\ACQ\
#        -On --use_c++_inline -I "C:\Program Files (x86)\IAR Systems\Embedded
#        Workbench 7.2\arm\CMSIS\Include\"
#    List file    =  
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\DZ-SB-DISC01\List\End_Point.lst
#    Object file  =  
#        E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\EWARM\DZ-SB-DISC01\Obj\End_Point.o
#
###############################################################################

E:\ACQ\Proj_ver09a_15102015\End_02\2013_11_25_Spirit1_Elektrolux\SPIRIT1_Library_Project\Application\examples\BasicGeneric\End_Point.c
      1          /**
      2          * @file    End_Poin.c
      3          * @author  
      4          * @version V0.0.2
      5          * @date    25 November 2013
      6          * @brief   Example of data transmission of SPIRIT1 Basic packets.
      7          * 
      8          */
      9          
     10          /* Includes ------------------------------------------------------------------*/
     11          #include "SDK_EVAL_Config.h"

   \                                 In section .text, align 2, keep-with-next
   \   static __interwork __softfp void NVIC_EnableIRQ(IRQn_Type)
   \                     NVIC_EnableIRQ: (+1)
   \   00000000   0x2101             MOVS     R1,#+1
   \   00000002   0xF010 0x021F      ANDS     R2,R0,#0x1F
   \   00000006   0x4091             LSLS     R1,R1,R2
   \   00000008   0x....             LDR.N    R2,??DataTable5  ;; 0xe000e100
   \   0000000A   0xB240             SXTB     R0,R0            ;; SignExt  R0,R0,#+24,#+24
   \   0000000C   0x0943             LSRS     R3,R0,#+5
   \   0000000E   0xF842 0x1023      STR      R1,[R2, R3, LSL #+2]
   \   00000012   0x4770             BX       LR               ;; return
     12          #include "SPIRIT_Config.h"
     13          #include "SDK_Configuration_Common.h"
     14          #include "SPIRIT_SDK_Application.h"
     15          #include "SPIRIT_Commands.h"
     16          #include "ACQ.h"
     17          
     18          #define LED_GREEN     LED2 
     19          #define LED_YELLOW    LED1
     20          
     21          #define FALSE 0
     22          #define TRUE !FALSE
     23          
     24          #define EnableInterrupts()   __set_PRIMASK(0);
     25          #define DisableInterrupts()  __set_PRIMASK(1);
     26          
     27          __ATTRIBUTES void          __set_PRIMASK( unsigned long );
     28          
     29          #undef MY_ADDRESS
     30          #define MY_ADDRESS                  0x44
     31          #undef DESTINATION_ADDRESS
     32          #define DESTINATION_ADDRESS         0x34
     33          
     34          void USART1_Init(void);
     35          void IWDG_Init(void);
     36          void SPIRIT_INIT(void);
     37          

   \                                 In section .data, align 4
     38            SRadioInit xRadioInit = {
   \                     xRadioInit:
   \   00000000   0x0000             DC16 0
   \   00000002   0x00 0x00          DC8 0, 0
   \   00000004   0x33C0EA18         DC32 868280856, 20000
   \              0x00004E20   
   \   0000000C   0x00 0x00          DC8 0, 0, 0, 0
   \              0x00 0x00    
   \   00000010   0x00009621         DC32 38433, 19836, 102115
   \              0x00004D7C   
   \              0x00018EE3   
     39              XTAL_OFFSET_PPM,
     40              BASE_FREQUENCY,
     41              CHANNEL_SPACE,
     42              CHANNEL_NUMBER,
     43              MODULATION_SELECT,
     44              DATARATE,
     45              FREQ_DEVIATION,
     46              BANDWIDTH
     47            };
     48          
     49          

   \                                 In section .data, align 4
     50          PktBasicInit xBasicInit={
   \                     xBasicInit:
   \   00000000   0x18 0x06          DC8 24, 6, 0, 0
   \              0x00 0x00    
   \   00000004   0x1A2635A8         DC32 438711720
   \   00000008   0x00 0x07          DC8 0, 7, 32, 0, 0, 0, 1, 0
   \              0x20 0x00    
   \              0x00 0x00    
   \              0x01 0x00    
     51            PREAMBLE_LENGTH,
     52            SYNC_LENGTH,
     53            SYNC_WORD,
     54            LENGTH_TYPE,
     55            LENGTH_WIDTH,
     56            CRC_MODE,
     57            CONTROL_LENGTH,
     58            EN_ADDRESS,
     59            EN_FEC,
     60            EN_WHITENING
     61          };
     62          
     63          

   \                                 In section .data, align 4
     64          PktBasicAddressesInit xAddressInit={
   \                     xAddressInit:
   \   00000000   0x00 0x44          DC8 0, 68, 0, 238, 0, 255, 0, 0
   \              0x00 0xEE    
   \              0x00 0xFF    
   \              0x00 0x00    
     65            EN_FILT_MY_ADDRESS,
     66            MY_ADDRESS,
     67            EN_FILT_MULTICAST_ADDRESS,
     68            MULTICAST_ADDRESS,
     69            EN_FILT_BROADCAST_ADDRESS,
     70            BROADCAST_ADDRESS
     71          };
     72          
     73          

   \                                 In section .data, align 4
     74          SGpioInit xGpioIRQ={
   \                     xGpioIRQ:
   \   00000000   0x05 0x02          DC8 5, 2, 0, 0
   \              0x00 0x00    
     75            SPIRIT_GPIO_0,
     76            SPIRIT_GPIO_MODE_DIGITAL_OUTPUT_LP,
     77            SPIRIT_GPIO_DIG_OUT_IRQ
     78          };
     79          

   \                                 In section .bss, align 4
     80          SpiritIrqs xIrqStatus;
   \                     xIrqStatus:
   \   00000000                      DS8 4
     81          

   \                                 In section .bss, align 4
     82          uint8_t vectcRxBuff[96], cRxData;
   \                     vectcRxBuff:
   \   00000000                      DS8 96

   \                                 In section .bss, align 1
   \                     cRxData:
   \   00000000                      DS8 1
     83          

   \                                 In section .data, align 4
     84          uint8_t vectcTxBuff[20]={0,0,88,88,88,88,70,71,72,73,74,75,76,77,78,79,80,81,82,0};
   \                     vectcTxBuff:
   \   00000000   0x00 0x00          DC8 0, 0, 88, 88, 88, 88, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80
   \              0x58 0x58    
   \              0x58 0x58    
   \              0x46 0x47    
   \              0x48 0x49    
   \              0x4A 0x4B    
   \              0x4C 0x4D    
   \              0x4E 0x4F    
   \              0x50         
   \   00000011   0x51 0x52          DC8 81, 82, 0
   \              0x00         
     85          

   \                                 In section .bss, align 1
     86          FlagStatus xTxDoneFlag = RESET;
   \                     xTxDoneFlag:
   \   00000000                      DS8 1
     87          

   \                                 In section .text, align 2, keep-with-next
     88          void M2S_GPIO_0_EXTI_IRQ_HANDLER(void)
     89          {
   \                     EXTI9_5_IRQHandler: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
     90            if(EXTI_GetFlagStatus(M2S_GPIO_0_EXTI_LINE))
   \   00000002   0x2020             MOVS     R0,#+32
   \   00000004   0x.... 0x....      BL       EXTI_GetFlagStatus
   \   00000008   0x2800             CMP      R0,#+0
   \   0000000A   0xD035             BEQ.N    ??EXTI9_5_IRQHandler_0
     91            {
     92              SpiritIrqGetStatus(&xIrqStatus); // Get the IRQ status
   \   0000000C   0x....             LDR.N    R0,??DataTable5_1
   \   0000000E   0x.... 0x....      BL       SpiritIrqGetStatus
     93                    if(xIrqStatus.IRQ_RX_DATA_DISC)  // Check the SPIRIT1 RX_DATA_DISC IRQ flag 
     94                  {
     95            //        SdkEvalLedToggle(LED_YELLOW);  // IRQ: Spirit1 RX data discarded (upon filtering)
     96                  }
     97              // Check the SPIRIT TX_DATA_SENT IRQ flag
     98              if(xIrqStatus.IRQ_TX_DATA_SENT)
   \   00000012   0x....             LDR.N    R0,??DataTable5_1
   \   00000014   0x7800             LDRB     R0,[R0, #+0]
   \   00000016   0xF3C0 0x0080      UBFX     R0,R0,#+2,#+1
   \   0000001A   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000001C   0x2800             CMP      R0,#+0
   \   0000001E   0xD005             BEQ.N    ??EXTI9_5_IRQHandler_1
     99              {
    100                // Set the xTxDoneFlag to manage processing of this event in the main()  
    101                xTxDoneFlag = SET;
   \   00000020   0x2001             MOVS     R0,#+1
   \   00000022   0x....             LDR.N    R1,??DataTable5_2
   \   00000024   0x7008             STRB     R0,[R1, #+0]
    102                SdkEvalLedToggle(LED_GREEN);
   \   00000026   0x2001             MOVS     R0,#+1
   \   00000028   0x.... 0x....      BL       SdkEvalLedToggle
    103              }
    104              if(xIrqStatus.IRQ_TX_FIFO_ERROR)
   \                     ??EXTI9_5_IRQHandler_1: (+1)
   \   0000002C   0x....             LDR.N    R0,??DataTable5_1
   \   0000002E   0x7800             LDRB     R0,[R0, #+0]
   \   00000030   0xF3C0 0x1040      UBFX     R0,R0,#+5,#+1
   \   00000034   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000036   0x2800             CMP      R0,#+0
   \   00000038   0xD002             BEQ.N    ??EXTI9_5_IRQHandler_2
    105              {
    106                //   
    107                xTxDoneFlag = SET;
   \   0000003A   0x2001             MOVS     R0,#+1
   \   0000003C   0x....             LDR.N    R1,??DataTable5_2
   \   0000003E   0x7008             STRB     R0,[R1, #+0]
    108          //      SdkEvalLedToggle(LED_GREEN);
    109              }
    110              if(xIrqStatus.IRQ_RX_DATA_READY)
   \                     ??EXTI9_5_IRQHandler_2: (+1)
   \   00000040   0x....             LDR.N    R0,??DataTable5_1
   \   00000042   0x7800             LDRB     R0,[R0, #+0]
   \   00000044   0xF010 0x0001      ANDS     R0,R0,#0x1
   \   00000048   0x2800             CMP      R0,#+0
   \   0000004A   0xD012             BEQ.N    ??EXTI9_5_IRQHandler_3
    111              {
    112                command_size = SpiritLinearFifoReadNumElementsRxFifo();  //get the size of received command
   \   0000004C   0x.... 0x....      BL       SpiritLinearFifoReadNumElementsRxFifo
   \   00000050   0x....             LDR.N    R1,??DataTable5_3
   \   00000052   0x6008             STR      R0,[R1, #+0]
    113                SpiritSpiReadLinearFifo(command_size, command_buffer);    //read the buffer
   \   00000054   0x....             LDR.N    R1,??DataTable5_4
   \   00000056   0x....             LDR.N    R0,??DataTable5_3
   \   00000058   0x6800             LDR      R0,[R0, #+0]
   \   0000005A   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000005C   0x.... 0x....      BL       SdkEvalSpiReadFifo
    114                SpiritCmdStrobeFlushRxFifo();     //flush the RX fifo
   \   00000060   0x2071             MOVS     R0,#+113
   \   00000062   0x.... 0x....      BL       SpiritCmdStrobeCommand
    115                SdkEvalLedToggle(LED_YELLOW);
   \   00000066   0x2000             MOVS     R0,#+0
   \   00000068   0x.... 0x....      BL       SdkEvalLedToggle
    116          //      SpiritCmdStrobeRx();
    117                command_pending = 1;
   \   0000006C   0x2001             MOVS     R0,#+1
   \   0000006E   0x....             LDR.N    R1,??DataTable5_5
   \   00000070   0x6008             STR      R0,[R1, #+0]
    118              }
    119              
    120              // Clear the EXTI line flag
    121             
    122              EXTI_ClearFlag(M2S_GPIO_0_EXTI_LINE);
   \                     ??EXTI9_5_IRQHandler_3: (+1)
   \   00000072   0x2020             MOVS     R0,#+32
   \   00000074   0x.... 0x....      BL       EXTI_ClearFlag
    123            }
    124          } // end of M2S_GPIO_0_EXTI_IRQ_HANDLER()
   \                     ??EXTI9_5_IRQHandler_0: (+1)
   \   00000078   0xBD01             POP      {R0,PC}          ;; return
    125          //void USART1_IRQn(void)     //// interupt from uart
    126          //{
    127          //
    128          //}
    129          
    130          
    131          

   \                                 In section .text, align 2, keep-with-next
    132          void main (void)
    133          {
   \                     main: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
    134            SPIRIT_INIT();
   \   00000002   0x.... 0x....      BL       SPIRIT_INIT
    135            while (1)
    136            {
    137              if (Spirit_data == Spirit_waiting_window)            // check if there is data ready to be sent
   \                     ??main_0: (+1)
   \   00000006   0x....             LDR.N    R0,??DataTable5_6
   \   00000008   0x6800             LDR      R0,[R0, #+0]
   \   0000000A   0x2805             CMP      R0,#+5
   \   0000000C   0xD106             BNE.N    ??main_1
    138              {
    139                if(SysyTickCnt > ((endpoint_address * 100) + 50))  // check if window for sending
   \   0000000E   0x....             LDR.N    R0,??DataTable5_7
   \   00000010   0x6800             LDR      R0,[R0, #+0]
   \   00000012   0xF5B0 0x7FE1      CMP      R0,#+450
   \   00000016   0xDD01             BLE.N    ??main_1
    140                  {
    141                    send_to_Base_Station();                       // sending to Base Station
   \   00000018   0x.... 0x....      BL       send_to_Base_Station
    142                  }
    143              }
    144              
    145              if(command_pending == 1)
   \                     ??main_1: (+1)
   \   0000001C   0x....             LDR.N    R0,??DataTable5_5
   \   0000001E   0x6800             LDR      R0,[R0, #+0]
   \   00000020   0x2801             CMP      R0,#+1
   \   00000022   0xD101             BNE.N    ??main_2
    146              {
    147                apply_command();
   \   00000024   0x.... 0x....      BL       apply_command
    148              }
    149                
    150              IWDG_ReloadCounter();          //przeladowanie IWDG    
   \                     ??main_2: (+1)
   \   00000028   0x.... 0x....      BL       IWDG_ReloadCounter
    151           //   SdkEvalLedToggle(LED_GREEN);
    152                
    153              if (App == App_connected)
   \   0000002C   0x....             LDR.N    R0,??DataTable5_8
   \   0000002E   0x6800             LDR      R0,[R0, #+0]
   \   00000030   0x2801             CMP      R0,#+1
   \   00000032   0xD102             BNE.N    ??main_3
    154              {
    155                daas_manage();
   \   00000034   0x.... 0x....      BL       daas_manage
   \   00000038   0xE7E5             B.N      ??main_0
    156              }else
    157              {
    158                app_connect();
   \                     ??main_3: (+1)
   \   0000003A   0x.... 0x....      BL       app_connect
   \   0000003E   0xE7E2             B.N      ??main_0
    159              }
    160             }
    161          }  // End of main()
    162              
    163          #ifdef USE_FULL_ASSERT
    164          /**
    165          * @brief  Reports the name of the source file and the source line number
    166          *         where the assert_param error has occurred.
    167          * @param file: pointer to the source file name
    168          * @param line: assert_param error line source number
    169          * @retval : None
    170          */   

   \                                 In section .text, align 2, keep-with-next
    171             void assert_failed(uint8_t* file, uint32_t line)
    172            {
   \                     assert_failed: (+1)
   \   00000000   0xB538             PUSH     {R3-R5,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x000D             MOVS     R5,R1
    173              // User can add his own implementation to report the file name and line number
    174              printf("Wrong parameters value: file %s on line %d\r\n", file, line);
   \   00000006   0x002A             MOVS     R2,R5
   \   00000008   0x0021             MOVS     R1,R4
   \   0000000A   0x....             LDR.N    R0,??DataTable5_9
   \   0000000C   0x.... 0x....      BL       printf
    175              
    176              // Enter Infinite Loop
    177              while (1)
   \                     ??assert_failed_0: (+1)
   \   00000010   0xE7FE             B.N      ??assert_failed_0
    178              {
    179                // Endless loop
    180              }
    181            } // End of assert_failed(file, line)
    182          #endif  // USE_FULL_ASSERT
    183          

   \                                 In section .text, align 2, keep-with-next
    184          void USART1_Init(void)
    185          {
   \                     USART1_Init: (+1)
   \   00000000   0xB500             PUSH     {LR}
   \   00000002   0xB087             SUB      SP,SP,#+28
    186            GPIO_InitTypeDef GPIO_InitStructure;
    187            USART_InitTypeDef USART1_InitStruct;
    188              
    189            GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9 | GPIO_Pin_10 ;
   \   00000004   0xF44F 0x60C0      MOV      R0,#+1536
   \   00000008   0x9000             STR      R0,[SP, #+0]
    190            GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
   \   0000000A   0x2002             MOVS     R0,#+2
   \   0000000C   0xF88D 0x0004      STRB     R0,[SP, #+4]
    191            GPIO_InitStructure.GPIO_Speed = GPIO_Speed_40MHz;
   \   00000010   0x2003             MOVS     R0,#+3
   \   00000012   0xF88D 0x0005      STRB     R0,[SP, #+5]
    192            GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL;
   \   00000016   0x2000             MOVS     R0,#+0
   \   00000018   0xF88D 0x0007      STRB     R0,[SP, #+7]
    193            GPIO_InitStructure.GPIO_OType = GPIO_OType_OD; 
   \   0000001C   0x2001             MOVS     R0,#+1
   \   0000001E   0xF88D 0x0006      STRB     R0,[SP, #+6]
    194            GPIO_Init(GPIOA, &GPIO_InitStructure);
   \   00000022   0xA900             ADD      R1,SP,#+0
   \   00000024   0x....             LDR.N    R0,??DataTable5_10  ;; 0x40020000
   \   00000026   0x.... 0x....      BL       GPIO_Init
    195               
    196            GPIO_PinAFConfig(GPIOA, GPIO_PinSource9,GPIO_AF_USART1);
   \   0000002A   0x2207             MOVS     R2,#+7
   \   0000002C   0x2109             MOVS     R1,#+9
   \   0000002E   0x....             LDR.N    R0,??DataTable5_10  ;; 0x40020000
   \   00000030   0x.... 0x....      BL       GPIO_PinAFConfig
    197            GPIO_PinAFConfig(GPIOA, GPIO_PinSource10,GPIO_AF_USART1);  
   \   00000034   0x2207             MOVS     R2,#+7
   \   00000036   0x210A             MOVS     R1,#+10
   \   00000038   0x....             LDR.N    R0,??DataTable5_10  ;; 0x40020000
   \   0000003A   0x.... 0x....      BL       GPIO_PinAFConfig
    198              
    199            /* Baud rate 115200, 8-bit data, One stop bit
    200             * No parity, Do both Rx and Tx, No HW flow control
    201             */
    202            USART1_InitStruct.USART_BaudRate = 9600;   
   \   0000003E   0xF44F 0x5016      MOV      R0,#+9600
   \   00000042   0x9002             STR      R0,[SP, #+8]
    203            USART1_InitStruct.USART_WordLength = USART_WordLength_9b;  
   \   00000044   0xF44F 0x5080      MOV      R0,#+4096
   \   00000048   0xF8AD 0x000C      STRH     R0,[SP, #+12]
    204            USART1_InitStruct.USART_StopBits = USART_StopBits_1;   
   \   0000004C   0x2000             MOVS     R0,#+0
   \   0000004E   0xF8AD 0x000E      STRH     R0,[SP, #+14]
    205            USART1_InitStruct.USART_Parity = USART_Parity_Even;
   \   00000052   0xF44F 0x6080      MOV      R0,#+1024
   \   00000056   0xF8AD 0x0010      STRH     R0,[SP, #+16]
    206           // USART1_InitStruct.USART_Parity = USART_Parity_No;
    207            USART1_InitStruct.USART_Mode = USART_Mode_Rx | USART_Mode_Tx;
   \   0000005A   0x200C             MOVS     R0,#+12
   \   0000005C   0xF8AD 0x0012      STRH     R0,[SP, #+18]
    208            USART1_InitStruct.USART_HardwareFlowControl = USART_HardwareFlowControl_None;
   \   00000060   0x2000             MOVS     R0,#+0
   \   00000062   0xF8AD 0x0014      STRH     R0,[SP, #+20]
    209              
    210            // Enable USART1
    211            USART_Cmd(USART1, ENABLE);  
   \   00000066   0x2101             MOVS     R1,#+1
   \   00000068   0x....             LDR.N    R0,??DataTable5_11  ;; 0x40013800
   \   0000006A   0x.... 0x....      BL       USART_Cmd
    212              
    213            // Configure USART1
    214            USART_Init(USART1, &USART1_InitStruct);
   \   0000006E   0xA902             ADD      R1,SP,#+8
   \   00000070   0x....             LDR.N    R0,??DataTable5_11  ;; 0x40013800
   \   00000072   0x.... 0x....      BL       USART_Init
    215              
    216            // Enable RXNE Interrupt
    217            USART_ITConfig(USART1, USART_IT_RXNE, ENABLE);
   \   00000076   0x2201             MOVS     R2,#+1
   \   00000078   0xF240 0x5125      MOVW     R1,#+1317
   \   0000007C   0x....             LDR.N    R0,??DataTable5_11  ;; 0x40013800
   \   0000007E   0x.... 0x....      BL       USART_ITConfig
    218            USART_ITConfig(USART1, USART_IT_TXE, ENABLE);
   \   00000082   0x2201             MOVS     R2,#+1
   \   00000084   0xF240 0x7127      MOVW     R1,#+1831
   \   00000088   0x....             LDR.N    R0,??DataTable5_11  ;; 0x40013800
   \   0000008A   0x.... 0x....      BL       USART_ITConfig
    219              
    220            // Enable USART1 Global Interrupt
    221          //  USART_ClearITPendingBit(USART1, USART_IT_TC);
    222            NVIC_EnableIRQ(USART1_IRQn); 
   \   0000008E   0x2025             MOVS     R0,#+37
   \   00000090   0x.... 0x....      BL       NVIC_EnableIRQ
    223          //USART_ClearITPendingBit(USART1, USART_IT_TC);  
    224          } // End of USART1_Init()
   \   00000094   0xB007             ADD      SP,SP,#+28
   \   00000096   0xBD00             POP      {PC}             ;; return
    225          
    226          

   \                                 In section .text, align 2, keep-with-next
    227          void IWDG_Init(void)
    228          {
   \                     IWDG_Init: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
    229            //konfigurowanie watchdoga IWDG
    230          IWDG_WriteAccessCmd(IWDG_WriteAccess_Enable);    // Zezwolenie na zapis rejestrów IWDG
   \   00000002   0xF245 0x5055      MOVW     R0,#+21845
   \   00000006   0x.... 0x....      BL       IWDG_WriteAccessCmd
    231          IWDG_SetPrescaler(IWDG_Prescaler_64);             // IWDG taktowany zegarem: 37kHz/64 = 0.578kHz
   \   0000000A   0x2004             MOVS     R0,#+4
   \   0000000C   0x.... 0x....      BL       IWDG_SetPrescaler
    232          IWDG_SetReload(0xFFF);                        // Przepelnienie IWDG po okolo 7s   
   \   00000010   0xF640 0x70FF      MOVW     R0,#+4095
   \   00000014   0x.... 0x....      BL       IWDG_SetReload
    233          IWDG_ReloadCounter();                           // Przeladowanie IWDG
   \   00000018   0x.... 0x....      BL       IWDG_ReloadCounter
    234          IWDG_Enable();                                  // Wlaczenie IWDG i LSI
   \   0000001C   0x.... 0x....      BL       IWDG_Enable
    235          }
   \   00000020   0xBD01             POP      {R0,PC}          ;; return
    236          

   \                                 In section .text, align 2, keep-with-next
    237          void SPIRIT_INIT(void)
    238          {
   \                     SPIRIT_INIT: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
    239            NVIC_SetVectorTable(NVIC_VectTab_FLASH, 0x0000);   // Use STM32L1xx_flash.icf
   \   00000002   0x2100             MOVS     R1,#+0
   \   00000004   0xF05F 0x6000      MOVS     R0,#+134217728
   \   00000008   0x.... 0x....      BL       NVIC_SetVectorTable
    240            RCC_APB2PeriphClockCmd(RCC_APB2Periph_USART1, ENABLE);
   \   0000000C   0x2101             MOVS     R1,#+1
   \   0000000E   0xF44F 0x4080      MOV      R0,#+16384
   \   00000012   0x.... 0x....      BL       RCC_APB2PeriphClockCmd
    241            RCC_AHBPeriphClockCmd(RCC_AHBPeriph_GPIOA | RCC_AHBPeriph_GPIOB | RCC_AHBPeriph_GPIOC, ENABLE );
   \   00000016   0x2101             MOVS     R1,#+1
   \   00000018   0x2007             MOVS     R0,#+7
   \   0000001A   0x.... 0x....      BL       RCC_AHBPeriphClockCmd
    242            SdkEvalIdentification();
   \   0000001E   0x.... 0x....      BL       SdkEvalIdentification
    243            SdkStartSysTick();
   \   00000022   0x.... 0x....      BL       SdkStartSysTick
    244            SysTick_CLKSourceConfig(SysTick_CLKSource_HCLK);
   \   00000026   0x2004             MOVS     R0,#+4
   \   00000028   0x.... 0x....      BL       SysTick_CLKSourceConfig
    245            SdkEvalLedInit(LED1);
   \   0000002C   0x2000             MOVS     R0,#+0
   \   0000002E   0x.... 0x....      BL       SdkEvalLedInit
    246            SdkEvalLedInit(LED2);
   \   00000032   0x2001             MOVS     R0,#+1
   \   00000034   0x.... 0x....      BL       SdkEvalLedInit
    247            SdkEvalM2SGpioInit(M2S_GPIO_SDN,M2S_MODE_GPIO_OUT);
   \   00000038   0x2102             MOVS     R1,#+2
   \   0000003A   0x2001             MOVS     R0,#+1
   \   0000003C   0x.... 0x....      BL       SdkEvalM2SGpioInit
    248            SpiritSpiInit();  
   \   00000040   0x.... 0x....      BL       SdkEvalSpiInit
    249            USART1_Init();
   \   00000044   0x.... 0x....      BL       USART1_Init
    250            
    251            SpiritEnterShutdown();
   \   00000048   0x.... 0x....      BL       SdkEvalEnterShutdown
    252            SpiritExitShutdown();
   \   0000004C   0x.... 0x....      BL       SdkEvalExitShutdown
    253            
    254            SpiritManagementIdentificationRFBoard();
   \   00000050   0x.... 0x....      BL       SpiritManagementIdentificationRFBoard
    255            SdkEvalM2SGpioInit(M2S_GPIO_0, M2S_MODE_EXTI_IN);
   \   00000054   0x2101             MOVS     R1,#+1
   \   00000056   0x2000             MOVS     R0,#+0
   \   00000058   0x.... 0x....      BL       SdkEvalM2SGpioInit
    256            
    257            SdkEvalM2SGpioInterruptCmd(M2S_GPIO_0,0x0F,0x0F,ENABLE);
   \   0000005C   0x2301             MOVS     R3,#+1
   \   0000005E   0x220F             MOVS     R2,#+15
   \   00000060   0x210F             MOVS     R1,#+15
   \   00000062   0x2000             MOVS     R0,#+0
   \   00000064   0x.... 0x....      BL       SdkEvalM2SGpioInterruptCmd
    258            SpiritGpioInit(&xGpioIRQ);
   \   00000068   0x....             LDR.N    R0,??DataTable5_12
   \   0000006A   0x.... 0x....      BL       SpiritGpioInit
    259            SpiritRadioInit(&xRadioInit);
   \   0000006E   0x....             LDR.N    R0,??DataTable5_13
   \   00000070   0x.... 0x....      BL       SpiritRadioInit
    260            SpiritPktBasicInit(&xBasicInit);
   \   00000074   0x....             LDR.N    R0,??DataTable5_14
   \   00000076   0x.... 0x....      BL       SpiritPktBasicInit
    261            SpiritPktBasicAddressesInit(&xAddressInit);
   \   0000007A   0x....             LDR.N    R0,??DataTable5_15
   \   0000007C   0x.... 0x....      BL       SpiritPktBasicAddressesInit
    262            SpiritIrqDeInit(&xIrqStatus);
   \   00000080   0x....             LDR.N    R0,??DataTable5_1
   \   00000082   0x.... 0x....      BL       SpiritIrqDeInit
    263             SpiritIrq(RX_DATA_DISC, S_ENABLE);
   \   00000086   0x2101             MOVS     R1,#+1
   \   00000088   0x2002             MOVS     R0,#+2
   \   0000008A   0x.... 0x....      BL       SpiritIrq
    264             SpiritIrq(RX_DATA_READY, S_ENABLE);  // testy dla odbioru komend !!!!!
   \   0000008E   0x2101             MOVS     R1,#+1
   \   00000090   0x2001             MOVS     R0,#+1
   \   00000092   0x.... 0x....      BL       SpiritIrq
    265            SpiritIrq(TX_DATA_SENT, S_ENABLE);
   \   00000096   0x2101             MOVS     R1,#+1
   \   00000098   0x2004             MOVS     R0,#+4
   \   0000009A   0x.... 0x....      BL       SpiritIrq
    266            SpiritIrq(TX_FIFO_ERROR, S_ENABLE);
   \   0000009E   0x2101             MOVS     R1,#+1
   \   000000A0   0x2020             MOVS     R0,#+32
   \   000000A2   0x.... 0x....      BL       SpiritIrq
    267            
    268            // Declare Length of Payload
    269            SpiritPktBasicSetPayloadLength(PAYLOAD_LENGTH);
   \   000000A6   0x2060             MOVS     R0,#+96
   \   000000A8   0x.... 0x....      BL       SpiritPktBasicSetPayloadLength
    270            
    271            SpiritQiSetSqiThreshold(SQI_TH_0);
   \   000000AC   0x2000             MOVS     R0,#+0
   \   000000AE   0x.... 0x....      BL       SpiritQiSetSqiThreshold
    272            SpiritQiSqiCheck(S_ENABLE); 
   \   000000B2   0x2001             MOVS     R0,#+1
   \   000000B4   0x.... 0x....      BL       SpiritQiSqiCheck
    273            SpiritIrqClearStatus();
   \   000000B8   0x.... 0x....      BL       SpiritIrqClearStatus
    274            
    275           // SET_INFINITE_RX_TIMEOUT();
    276            SpiritTimerSetRxTimeoutMs(RX_TIMEOUT);
   \   000000BC   0x....             LDR.N    R0,??DataTable5_16  ;; 0x425c0000
   \   000000BE   0x.... 0x....      BL       SpiritTimerSetRxTimeoutMs
    277            //SpiritTimerSetRxTimeoutStopCondition(TIMEOUT_ALWAYS_STOPPED);
    278            SpiritTimerSetRxTimeoutStopCondition(SQI_ABOVE_THRESHOLD);
   \   000000C2   0x2002             MOVS     R0,#+2
   \   000000C4   0x.... 0x....      BL       SpiritTimerSetRxTimeoutStopCondition
    279            
    280            SpiritIrqClearStatus();
   \   000000C8   0x.... 0x....      BL       SpiritIrqClearStatus
    281            //USART_Conf();
    282            
    283            //*** For test purposes only: create unsigned, 16-bit counter
    284            vectcTxBuff[0] = 0;   // Clear Counter to overwrite initial values
   \   000000CC   0x2000             MOVS     R0,#+0
   \   000000CE   0x....             LDR.N    R1,??DataTable5_17
   \   000000D0   0x7008             STRB     R0,[R1, #+0]
    285            vectcTxBuff[1] = 0;
   \   000000D2   0x2000             MOVS     R0,#+0
   \   000000D4   0x....             LDR.N    R1,??DataTable5_17
   \   000000D6   0x7048             STRB     R0,[R1, #+1]
    286            SdkDelayMs(2000);  //wait till the tested board FW active
   \   000000D8   0xF44F 0x60FA      MOV      R0,#+2000
   \   000000DC   0x.... 0x....      BL       SdkDelayMs
    287           // IWDG_Init();      // let the dogs out,
    288          }
   \   000000E0   0xBD01             POP      {R0,PC}          ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5:
   \   00000000   0xE000E100         DC32     0xe000e100

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_1:
   \   00000000   0x........         DC32     xIrqStatus

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_2:
   \   00000000   0x........         DC32     xTxDoneFlag

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_3:
   \   00000000   0x........         DC32     command_size

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_4:
   \   00000000   0x........         DC32     command_buffer

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_5:
   \   00000000   0x........         DC32     command_pending

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_6:
   \   00000000   0x........         DC32     Spirit_data

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_7:
   \   00000000   0x........         DC32     SysyTickCnt

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_8:
   \   00000000   0x........         DC32     App

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_9:
   \   00000000   0x........         DC32     ?_0

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_10:
   \   00000000   0x40020000         DC32     0x40020000

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_11:
   \   00000000   0x40013800         DC32     0x40013800

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_12:
   \   00000000   0x........         DC32     xGpioIRQ

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_13:
   \   00000000   0x........         DC32     xRadioInit

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_14:
   \   00000000   0x........         DC32     xBasicInit

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_15:
   \   00000000   0x........         DC32     xAddressInit

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_16:
   \   00000000   0x425C0000         DC32     0x425c0000

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable5_17:
   \   00000000   0x........         DC32     vectcTxBuff

   \                                 In section .rodata, align 4
   \                     ?_0:
   \   00000000   0x57 0x72          DC8 "Wrong parameters value: file %s on line %d\015\012"
   \              0x6F 0x6E    
   \              0x67 0x20    
   \              0x70 0x61    
   \              0x72 0x61    
   \              0x6D 0x65    
   \              0x74 0x65    
   \              0x72 0x73    
   \              0x20 0x76    
   \              0x61 0x6C    
   \              0x75 0x65    
   \              0x3A 0x20    
   \              0x66 0x69    
   \              0x6C 0x65    
   \              0x20 0x25    
   \              0x73 0x20    
   \              0x6F 0x6E    
   \              0x20 0x6C    
   \              0x69 0x6E    
   \              0x65 0x20    
   \              0x25 0x64    
   \              0x0D 0x0A    
   \              0x00         
   \   0000002D   0x00 0x00          DC8 0, 0, 0
   \              0x00         
    289          
    290          
    291          
    292          
    293          
    294          
    295          
    296          
    297          
    298          
    299          
    300          
    301          
    302          
    303          
    304          
    305          
    306          
    307          
    308          /**************** (C) COPYRIGHT 2013 DiZiC Ltd. ********* END OF FILE *********/

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       8   EXTI9_5_IRQHandler
         8   -> EXTI_ClearFlag
         8   -> EXTI_GetFlagStatus
         8   -> SdkEvalLedToggle
         8   -> SdkEvalSpiReadFifo
         8   -> SpiritCmdStrobeCommand
         8   -> SpiritIrqGetStatus
         8   -> SpiritLinearFifoReadNumElementsRxFifo
       8   IWDG_Init
         8   -> IWDG_Enable
         8   -> IWDG_ReloadCounter
         8   -> IWDG_SetPrescaler
         8   -> IWDG_SetReload
         8   -> IWDG_WriteAccessCmd
       0   NVIC_EnableIRQ
       8   SPIRIT_INIT
         8   -> NVIC_SetVectorTable
         8   -> RCC_AHBPeriphClockCmd
         8   -> RCC_APB2PeriphClockCmd
         8   -> SdkDelayMs
         8   -> SdkEvalEnterShutdown
         8   -> SdkEvalExitShutdown
         8   -> SdkEvalIdentification
         8   -> SdkEvalLedInit
         8   -> SdkEvalM2SGpioInit
         8   -> SdkEvalM2SGpioInterruptCmd
         8   -> SdkEvalSpiInit
         8   -> SdkStartSysTick
         8   -> SpiritGpioInit
         8   -> SpiritIrq
         8   -> SpiritIrqClearStatus
         8   -> SpiritIrqDeInit
         8   -> SpiritManagementIdentificationRFBoard
         8   -> SpiritPktBasicAddressesInit
         8   -> SpiritPktBasicInit
         8   -> SpiritPktBasicSetPayloadLength
         8   -> SpiritQiSetSqiThreshold
         8   -> SpiritQiSqiCheck
         8   -> SpiritRadioInit
         8   -> SpiritTimerSetRxTimeoutMs
         8   -> SpiritTimerSetRxTimeoutStopCondition
         8   -> SysTick_CLKSourceConfig
         8   -> USART1_Init
      32   USART1_Init
        32   -> GPIO_Init
        32   -> GPIO_PinAFConfig
        32   -> NVIC_EnableIRQ
        32   -> USART_Cmd
        32   -> USART_ITConfig
        32   -> USART_Init
      16   assert_failed
        16   -> printf
       8   main
         8   -> IWDG_ReloadCounter
         8   -> SPIRIT_INIT
         8   -> app_connect
         8   -> apply_command
         8   -> daas_manage
         8   -> send_to_Base_Station


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable5
       4  ??DataTable5_1
       4  ??DataTable5_10
       4  ??DataTable5_11
       4  ??DataTable5_12
       4  ??DataTable5_13
       4  ??DataTable5_14
       4  ??DataTable5_15
       4  ??DataTable5_16
       4  ??DataTable5_17
       4  ??DataTable5_2
       4  ??DataTable5_3
       4  ??DataTable5_4
       4  ??DataTable5_5
       4  ??DataTable5_6
       4  ??DataTable5_7
       4  ??DataTable5_8
       4  ??DataTable5_9
      48  ?_0
     122  EXTI9_5_IRQHandler
      34  IWDG_Init
      20  NVIC_EnableIRQ
     226  SPIRIT_INIT
     152  USART1_Init
      18  assert_failed
       1  cRxData
      64  main
      96  vectcRxBuff
      20  vectcTxBuff
       8  xAddressInit
      16  xBasicInit
       4  xGpioIRQ
       4  xIrqStatus
      28  xRadioInit
       1  xTxDoneFlag

 
 102 bytes in section .bss
  76 bytes in section .data
  48 bytes in section .rodata
 708 bytes in section .text
 
 708 bytes of CODE  memory
  48 bytes of CONST memory
 178 bytes of DATA  memory

Errors: none
Warnings: none
